{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Downloads/code/dajia/frontend/src/page/backend_component/new_performance.js\",\n    _s = $RefreshSig$();\n\nimport { useParams } from \"react-router-dom\";\nimport { Return_component } from \"./data_input\";\nimport { Loading } from \"./loading\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { insert_performance_table } from \"../api\";\nimport { select } from \"react-cookies\";\nimport { check_and_recatch_data } from \"../method/method_func\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst New_performance = _ref => {\n  _s();\n\n  let {\n    data,\n    synchronize_update,\n    synchronize\n  } = _ref;\n  const {\n    page\n  } = useParams();\n  var token = window.sessionStorage.getItem('token');\n  const [confirm_data, set_confirm_data] = useState([]);\n  const [page_data_arr, set_page_data_arr] = useState([]);\n  const [select_year, set_select_year] = useState(0);\n  const year = ['請選擇年份'];\n  var Today = new Date();\n\n  for (let i = -20; i < 3; i++) {\n    year.push(Today.getFullYear() - 1911 + i);\n  }\n\n  useEffect(() => {\n    if (data.length !== 0) {\n      set_page_data_arr(data);\n      var arr = data.map(item => {\n        return [item[0], select_year, 'yes']; //account,year,(yes or no)\n        //yes =>this people need to insert to the table\n        //no =>this people dont need to insert to the table\n      });\n      set_confirm_data(arr);\n    } else {\n      set_page_data_arr([]);\n      set_confirm_data([]);\n    }\n  }, [page, data, select_year]);\n\n  async function insert() {\n    //send api to insert performance table\n    //api(token,confirm_data)\n    var result = await insert_performance_table(token, confirm_data);\n\n    if (result === '新增成ㄍㄨㄥ') {\n      check_and_recatch_data(token, synchronize_update, 2000);\n    }\n\n    alert(result);\n  }\n\n  if (!page_data_arr || synchronize === true) {\n    return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 16\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"select\", {\n      onChange: e => set_select_year(e.target.value),\n      children: year.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          value: index !== 0 ? item : 0,\n          children: index !== 0 ? `民國${item}` : item\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 36\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 17\n    }, this), page_data_arr.length !== 0 ? /*#__PURE__*/_jsxDEV(Return_component, {\n      synchronize_update: synchronize_update,\n      number: 5,\n      page: page,\n      confirm_data: confirm_data,\n      set_confirm_data: set_confirm_data,\n      arr_params: data\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 100000\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        name: \"create\",\n        onClick: insert,\n        children: \"\\u78BA\\u8A8D\\u65B0\\u589E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(New_performance, \"69l+VjgT1XHML201mZwkdRdbvGY=\", false, function () {\n  return [useParams];\n});\n\n_c = New_performance;\nexport default New_performance;\n\nvar _c;\n\n$RefreshReg$(_c, \"New_performance\");","map":{"version":3,"sources":["/Users/admin/Downloads/code/dajia/frontend/src/page/backend_component/new_performance.js"],"names":["useParams","Return_component","Loading","useState","useEffect","useRef","insert_performance_table","select","check_and_recatch_data","New_performance","data","synchronize_update","synchronize","page","token","window","sessionStorage","getItem","confirm_data","set_confirm_data","page_data_arr","set_page_data_arr","select_year","set_select_year","year","Today","Date","i","push","getFullYear","length","arr","map","item","insert","result","alert","e","target","value","index","display","alignItems","justifyContent","zIndex"],"mappings":"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","sourcesContent":["import { useParams } from \"react-router-dom\"\nimport { Return_component } from \"./data_input\"\nimport { Loading } from \"./loading\"\nimport { useState,useEffect, useRef } from \"react\"\nimport { insert_performance_table } from \"../api\"\nimport { select } from \"react-cookies\"\nimport { check_and_recatch_data } from \"../method/method_func\"\nconst New_performance=({data,synchronize_update,synchronize})=>{\n    const {page}=useParams()\n    var token=window.sessionStorage.getItem('token')\n    const [confirm_data,set_confirm_data]=useState([])\n    const [page_data_arr,set_page_data_arr]=useState([])\n    const [select_year,set_select_year]=useState(0)\n\n    const year=['請選擇年份']\n    var Today=new Date();\n    for(let i=-20;i<3;i++){\n        year.push(Today.getFullYear()-1911+i)\n    }\n    useEffect(()=>{\n        if(data.length!==0){\n            set_page_data_arr(data)\n            var arr=data.map((item)=>{\n                return([item[0],select_year,'yes'])//account,year,(yes or no)\n                //yes =>this people need to insert to the table\n                //no =>this people dont need to insert to the table\n            })\n            set_confirm_data(arr)\n        }\n        else{\n            set_page_data_arr([])\n            set_confirm_data([])\n        }\n    },[page,data,select_year])\n\n    async function insert(){\n        //send api to insert performance table\n        //api(token,confirm_data)\n        var result=await insert_performance_table(token,confirm_data)\n        if(result==='新增成ㄍㄨㄥ'){\n            check_and_recatch_data(token,synchronize_update,2000)\n        }\n        alert(result)\n    }\n\n    if(!page_data_arr||synchronize===true){\n        return(<Loading/>)\n    }\n    return(\n<>\n                <select onChange={(e)=>set_select_year(e.target.value)}>\n                    {\n                        year.map((item,index)=>{\n                            return(<option value={index!==0?item:0} key={index}>{index!==0?`民國${item}`:item}</option>)\n                        })\n                    }\n                </select>\n            {\n                page_data_arr.length!==0\n                ?<Return_component \n                    synchronize_update={synchronize_update}\n                    number={5}\n                    page={page}\n                    confirm_data={confirm_data}\n                    set_confirm_data={set_confirm_data}\n                    arr_params={data}/>\n                :<></>\n            }\n            <div style={{display:'flex',alignItems:'center',justifyContent:'center',zIndex:100000}}>\n                <button name=\"create\" \n                    onClick={insert}>確認新增</button>\n            </div>\n</>\n    )\n}\nexport default New_performance;"]},"metadata":{},"sourceType":"module"}