{"ast":null,"code":"import _objectSpread from\"/Users/admin/Downloads/code/dajia/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/admin/Downloads/code/dajia/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/admin/Downloads/code/dajia/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/admin/Downloads/code/dajia/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{Fragment}from\"react\";import{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{login,select_route,backend,banch_index,year_performance,select_all_banch}from'./api';import{fade_in}from\"./fade_in\";import{Loading}from\"./backend_component/loading\";import{Login_loading}from\"./backend_component/login_loadind\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(_ref){var set_permession_state=_ref.set_permession_state;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),load_in=_useState2[0],set_load_in=_useState2[1];var _useState3=useState('登入中'),_useState4=_slicedToArray(_useState3,2),text=_useState4[0],set_text=_useState4[1];var _useState5=useState({account:'',password:''}),_useState6=_slicedToArray(_useState5,2),login_data=_useState6[0],set_login_data=_useState6[1];var _useState7=useState({opacity:0,transition:''}),_useState8=_slicedToArray(_useState7,2),style0=_useState8[0],set_style0=_useState8[1];var _useState9=useState({opacity:0,transition:''}),_useState10=_slicedToArray(_useState9,2),style1=_useState10[0],set_style1=_useState10[1];var _useState11=useState({opacity:0,transition:''}),_useState12=_slicedToArray(_useState11,2),style2=_useState12[0],set_style2=_useState12[1];var _useState13=useState({opacity:0,transition:'',marginTop:'3vh'}),_useState14=_slicedToArray(_useState13,2),style3=_useState14[0],set_style3=_useState14[1];var navigate=useNavigate();useEffect(function(){var token=window.sessionStorage.getItem('token');if(token){select_route(navigate);}else{set_permession_state(false);}fade_in(style0,set_style0,0,'1s');fade_in(style1,set_style1,300,'0.3s');fade_in(style2,set_style2,700,'0.7s');fade_in(style3,set_style3,1100,'1.1s');},[]);var key_press_enter=function key_press_enter(event){if(event.key===\"Enter\"||event.key===\"enter\"){a();}};function a(){return _a.apply(this,arguments);}function _a(){_a=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var states,token,result3,result1,result2,result4,timer;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:set_load_in(true);set_text('正在驗證登入資訊');_context.next=4;return login(login_data);case 4:states=_context.sent;if(!states){_context.next=25;break;}setTimeout(function(){set_text('正在收集資料');},500);set_permession_state(true);token=window.sessionStorage.getItem('token');_context.next=11;return year_performance(token);case 11:result3=_context.sent;_context.next=14;return banch_index(token);case 14:result1=_context.sent;_context.next=17;return backend(token);case 17:result2=_context.sent;_context.next=20;return select_all_banch(token);case 20:result4=_context.sent;console.log('here');timer=setInterval(function(){if(result1&&result2&&result3&&result4){set_load_in(false);//代表資料已經更新\nclearInterval(timer);select_route(navigate);}},10);_context.next=26;break;case 25:set_load_in(false);case 26:case\"end\":return _context.stop();}}},_callee);}));return _a.apply(this,arguments);}return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"loginbox\",children:[/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},style0),{},{display:load_in===false?\"block\":'none'}),onKeyDown:function onKeyDown(event){return key_press_enter(event);},className:\"login\",children:[/*#__PURE__*/_jsx(\"p\",{style:{marginBottom:'8vh'},children:\"\\u767B\\u5165\"}),/*#__PURE__*/_jsx(\"input\",{style:style1,value:login_data.account,onChange:function onChange(e){return set_login_data(_objectSpread(_objectSpread({},login_data),{},{account:e.target.value}));},type:\"text\",placeholder:\"\\u8ACB\\u8F38\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{style:style2,value:login_data.password,onChange:function onChange(e){return set_login_data(_objectSpread(_objectSpread({},login_data),{},{password:e.target.value}));},type:\"password\",placeholder:\"\\u8ACB\\u8F38\\u5165\\u5BC6\\u78BC\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{style:style3,onClick:a,children:\"\\u767B\\u5165\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:load_in===false?'none':'flex',alignItems:'center'},className:\"login\",children:/*#__PURE__*/_jsx(Login_loading,{text:text})})]})});};export default Login;","map":{"version":3,"sources":["/Users/admin/Downloads/code/dajia/frontend/src/page/login.js"],"names":["Fragment","useState","useEffect","useNavigate","login","select_route","backend","banch_index","year_performance","select_all_banch","fade_in","Loading","Login_loading","Login","set_permession_state","load_in","set_load_in","text","set_text","account","password","login_data","set_login_data","opacity","transition","style0","set_style0","style1","set_style1","style2","set_style2","marginTop","style3","set_style3","navigate","token","window","sessionStorage","getItem","key_press_enter","event","key","a","states","setTimeout","result3","result1","result2","result4","console","log","timer","setInterval","clearInterval","display","marginBottom","e","target","value","alignItems"],"mappings":"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","sourcesContent":["import { Fragment } from \"react\"\nimport { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { login, select_route, backend, banch_index, year_performance, select_all_banch } from './api'\nimport { fade_in } from \"./fade_in\";\nimport { Loading } from \"./backend_component/loading\";\nimport { Login_loading } from \"./backend_component/login_loadind\";\nconst Login = ({ set_permession_state }) => {\n    const [load_in, set_load_in] = useState(false)\n    const [text, set_text] = useState('登入中')\n    const [login_data, set_login_data] = useState({\n        account: '',\n        password: ''\n    })\n    const [style0, set_style0] = useState(\n        { opacity: 0, transition: '' }\n    )\n    const [style1, set_style1] = useState(\n        { opacity: 0, transition: '' }\n    )\n    const [style2, set_style2] = useState(\n        { opacity: 0, transition: '' }\n    )\n    const [style3, set_style3] = useState(\n        { opacity: 0, transition: '', marginTop: '3vh' }\n    )\n\n    const navigate = useNavigate()\n\n    useEffect(() => {\n        var token = window.sessionStorage.getItem('token')\n        if (token) { select_route(navigate) }\n        else { set_permession_state(false) }\n        fade_in(style0, set_style0, 0, '1s')\n        fade_in(style1, set_style1, 300, '0.3s')\n        fade_in(style2, set_style2, 700, '0.7s')\n        fade_in(style3, set_style3, 1100, '1.1s')\n    }, [])\n\n\n    const key_press_enter = (event) => {\n        if (event.key === \"Enter\" || event.key === \"enter\") {\n            a()\n        }\n    }\n    async function a() {\n        set_load_in(true)\n        set_text('正在驗證登入資訊')\n        var states = await login(login_data)//return true or false\n        if (states) {\n            setTimeout(() => {\n                set_text('正在收集資料')\n            }, 500)\n\n            set_permession_state(true)\n\n            var token = window.sessionStorage.getItem('token')\n            var result3 = await year_performance(token)\n            var result1 = await banch_index(token)\n            var result2 = await backend(token)\n            var result4 = await select_all_banch(token)\n            console.log('here')\n            var timer = setInterval(() => {\n                if (result1 && result2 && result3 && result4) {\n\n                    set_load_in(false)\n                    //代表資料已經更新\n                    clearInterval(timer)\n                    select_route(navigate)\n                }\n\n            }, 10);\n        }\n        else {\n            set_load_in(false)\n        }\n    }\n\n\n\n    return (\n        <Fragment>\n            <div className=\"loginbox\">\n                <div style={{ ...style0, display: load_in === false ? \"block\" : 'none' }} onKeyDown={(event) => key_press_enter(event)} className=\"login\">\n                    <p style={{ marginBottom: '8vh' }}>登入</p>\n                    <input style={style1} value={login_data.account} onChange={(e) => set_login_data({ ...login_data, account: e.target.value })} type=\"text\" placeholder=\"請輸入帳號\" /><br />\n\n                    <input style={style2} value={login_data.password} onChange={(e) => set_login_data({ ...login_data, password: e.target.value })} type=\"password\" placeholder=\"請輸入密碼\" /><br />\n                    <button style={style3} onClick={a}\n                    >登入</button>\n                </div>\n                <div style={{ display: load_in === false ? 'none' : 'flex', alignItems: 'center' }} className='login'>\n                    <Login_loading text={text} />\n                </div>\n            </div>\n\n\n        </Fragment>\n    )\n}\nexport default Login;"]},"metadata":{},"sourceType":"module"}