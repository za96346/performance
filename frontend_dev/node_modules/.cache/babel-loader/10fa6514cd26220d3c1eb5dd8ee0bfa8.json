{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Downloads/code/dajia/frontend/src/page/backend_component/word_preview.js\",\n    _s = $RefreshSig$();\n\nimport { useState } from 'react';\nimport FileViewer from 'react-file-viewer';\nimport pdfjsLib from 'pdfjs-dist/webpack';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Word_preview = () => {\n  _s();\n\n  const [renderContext, set_render] = useState({}); //https://docs.google.com/viewer?url=[file_url]&embedded=true\n  //https://view.officeapps.live.com/op/embed.aspx?src=[file_url]\n\n  const doc_url = 'https://github.com/za96346/dajia_project/blob/main/這個是舊版的.doc?raw=true';\n\n  async function file() {\n    const pdf = await pdfjsLib.getDocument(doc_url);\n    const {\n      _pdfInfo: {\n        numPages\n      }\n    } = pdf;\n\n    for (let _page = 1; _page <= numPages; _page++) {\n      pdf.getPage(_page).then(page => {\n        const viewport = page.getViewport({\n          scale: 1\n        });\n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d');\n        canvas.height = viewport.height;\n        canvas.width = viewport.width;\n        const render = {\n          canvasContext: context,\n          viewport: viewport,\n          enableWebGL: true\n        };\n        page.render(renderContext);\n      });\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n      style: {\n        width: '100%',\n        height: '100%',\n        border: 'none'\n      },\n      src: \"https://view.officeapps.live.com/op/embed.aspx?src=https://github.com/za96346/dajia_project/blob/main/\\u9019\\u500B\\u662F\\u820A\\u7248\\u7684.doc?raw=true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(Word_preview, \"pLGqsny3W+gkUAIUcZiiud6lDkc=\");\n\n_c = Word_preview;\nexport default Word_preview;\n\nvar _c;\n\n$RefreshReg$(_c, \"Word_preview\");","map":{"version":3,"sources":["/Users/admin/Downloads/code/dajia/frontend/src/page/backend_component/word_preview.js"],"names":["useState","FileViewer","pdfjsLib","Word_preview","renderContext","set_render","doc_url","file","pdf","getDocument","_pdfInfo","numPages","_page","getPage","then","page","viewport","getViewport","scale","canvas","document","createElement","context","getContext","height","width","render","canvasContext","enableWebGL","border"],"mappings":";;;AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,OAAOC,UAAP,MAAwB,mBAAxB;AACA,OAAOC,QAAP,MAAqB,oBAArB;;;;AACA,MAAMC,YAAY,GAAC,MAAI;AAAA;;AACnB,QAAM,CAACC,aAAD,EAAeC,UAAf,IAA2BL,QAAQ,CAAC,EAAD,CAAzC,CADmB,CAGnB;AACA;;AACA,QAAMM,OAAO,GAAC,wEAAd;;AACA,iBAAeC,IAAf,GAAqB;AACjB,UAAMC,GAAG,GAAG,MAAMN,QAAQ,CAACO,WAAT,CAAqBH,OAArB,CAAlB;AACA,UAAM;AAACI,MAAAA,QAAQ,EAAE;AAACC,QAAAA;AAAD;AAAX,QAAyBH,GAA/B;;AACA,SAAK,IAAII,KAAK,GAAG,CAAjB,EAAoBA,KAAK,IAAID,QAA7B,EAAuCC,KAAK,EAA5C,EAAgD;AAC5CJ,MAAAA,GAAG,CAACK,OAAJ,CAAYD,KAAZ,EAAmBE,IAAnB,CAAyBC,IAAD,IAAU;AAC9B,cAAMC,QAAQ,GAAGD,IAAI,CAACE,WAAL,CAAiB;AAACC,UAAAA,KAAK,EAAE;AAAR,SAAjB,CAAjB;AACA,cAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACA,cAAMC,OAAO,GAAGH,MAAM,CAACI,UAAP,CAAkB,IAAlB,CAAhB;AACAJ,QAAAA,MAAM,CAACK,MAAP,GAAgBR,QAAQ,CAACQ,MAAzB;AACAL,QAAAA,MAAM,CAACM,KAAP,GAAeT,QAAQ,CAACS,KAAxB;AACA,cAAMC,MAAM,GAAG;AACXC,UAAAA,aAAa,EAAEL,OADJ;AAEXN,UAAAA,QAAQ,EAAEA,QAFC;AAGXY,UAAAA,WAAW,EAAE;AAHF,SAAf;AAKAb,QAAAA,IAAI,CAACW,MAAL,CAAYtB,aAAZ;AAEH,OAbD;AAeH;AACJ;;AAID,sBACI;AAAA,2BAEI;AAAQ,MAAA,KAAK,EAAE;AAACqB,QAAAA,KAAK,EAAC,MAAP;AAAcD,QAAAA,MAAM,EAAC,MAArB;AAA4BK,QAAAA,MAAM,EAAC;AAAnC,OAAf;AAA6D,MAAA,GAAG,EAAC;AAAjE;AAAA;AAAA;AAAA;AAAA;AAFJ,mBADJ;AAWH,CAzCD;;GAAM1B,Y;;KAAAA,Y;AA0CN,eAAeA,YAAf","sourcesContent":["import { useState } from 'react';\nimport FileViewer  from 'react-file-viewer';\nimport pdfjsLib from 'pdfjs-dist/webpack'; \nconst Word_preview=()=>{\n    const [renderContext,set_render]=useState({})\n    \n    //https://docs.google.com/viewer?url=[file_url]&embedded=true\n    //https://view.officeapps.live.com/op/embed.aspx?src=[file_url]\n    const doc_url='https://github.com/za96346/dajia_project/blob/main/這個是舊版的.doc?raw=true'\n    async function file(){\n        const pdf = await pdfjsLib.getDocument(doc_url)\n        const {_pdfInfo: {numPages}} = pdf \n        for (let _page = 1; _page <= numPages; _page++) {  \n            pdf.getPage(_page).then((page) => {  \n                const viewport = page.getViewport({scale: 1})  \n                const canvas = document.createElement('canvas')  \n                const context = canvas.getContext('2d')  \n                canvas.height = viewport.height  \n                canvas.width = viewport.width  \n                const render = {  \n                    canvasContext: context,  \n                    viewport: viewport,  \n                    enableWebGL: true,  \n                }  \n                page.render(renderContext) \n                 \n            });  \n\n        }\n    }\n    \n\n\n    return(\n        <>\n        \n            <iframe style={{width:'100%',height:'100%',border:'none',}}  src='https://view.officeapps.live.com/op/embed.aspx?src=https://github.com/za96346/dajia_project/blob/main/這個是舊版的.doc?raw=true'></iframe>\n        {/* \n        <FileViewer fileType='docx'\n                    filePath={require('/Users/admin/Downloads/code/dajia/frontend/src/static/demo.docx')}\n                    />\n        */}\n    </>\n    )\n}\nexport default Word_preview;"]},"metadata":{},"sourceType":"module"}